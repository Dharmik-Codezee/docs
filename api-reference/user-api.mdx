---
title: User API Documentation
excludeFromToc: true
---

<!-- User create -->

# User Signup API

## Endpoint

`POST /api/user/signup/:user_type`

This endpoint is used for user registration, allowing the creation of different user types based on the user_type parameter.

#### Request Parameters
`user_type` (URL parameter): The type of user to be created. Should be a non-empty string.

####  Request Body Parameters
`first_name` (Body parameter): The first name of the user. Should be a non-empty string.
`country_code` (Body parameter): The country code of the user. Should be a non-empty string.
`mobile_no` (Body parameter): The mobile number of the user. Should be a non-empty string.

####  Middleware
The endpoint utilizes a middleware function, userCreateMid, which performs input validation and invokes the user creation process.

####  Validation
The middleware employs Express Validator to validate request parameters and body data. Validation includes checking for empty values and validating email format.

#### User Creation Process
#### Input Validation:

Checks for validation errors using Express Validator.
If errors are found, returns a validation response.

#### Email Validation:

If the user provides an email (user_email), validates its format.
If the email is invalid, returns a validation response with a specific message.

####  User Type Handling:

Determines the numeric user type based on the provided user_type.
If the user type is neither "jobseeker" nor "business," returns an error response.

####  User Data Formatting:

Formats user data based on user type for database insertion.

####  User Creation:

Creates a user record using the userModel with the formatted data.
Returns a success response if the user is created; otherwise, returns an error response.

####  Error Handling:
Errors during the user creation process are appropriately handled, and detailed error messages are returned in the response.

####  User Controller Functions: 
userCreateMid(req: Request, res: Response)
Middleware function for user creation, performing input validation and triggering the user creation API.

####  userCreateApi(data: any, callback: Function)
Controller function for creating a user based on the provided data. Handles user type validation, data formatting, and database insertion.

####  User Model
The user model (userModel) is used to interact with the database for user creation.

####  User Data Structure
The structure of the user data includes various fields such as first_name, country_code, mobile_no, user_email, etc., with optional fields based on the user type.

This documentation provides an overview of the POST /api/user/signup/:user_type endpoint, including request parameters, body parameters, middleware, validation, user creation process, error handling, and relevant controller functions and models.

### Request body for Jobseeker

```json
{
    "first_name": "Somchai",  
    "last_name": "Anant",
    "country_code": "+66",
    "mobile_no": "655597453",
    "user_email": "somchai@gmail.com",
    "date_of_birth":"2024-01-18",
    "gender": "male",
    "profile_img": "images/photo.jpeg",
    "identity_card":"images/id_card.jpeg",
    "skills": ["leadership", "communication", "marketing"],
    "notification": true,
    "open_to_work": true,
    "language": 1
}
```

Response header
```json
{
  "status": 200,
  "err": 0,
  "data": {
    "first_name": "Somchai",
    "last_name": "Anant",
    "country_code": "+66",
    "mobile_no": "655597453",
    "user_email": "somchai@gmail.com",
    "date_of_birth": "2024-01-18T00:00:00.000Z",
    "gender": "male",
    "user_type": 1,
    "profile_img": "images/photo.jpeg",
    "identity_card": "images/id_card.jpeg",
    "skills": [
      "leadership",
      "communication",
      "marketing"
    ],
    "notification": true,
    "open_to_work": true,
    "language": 1,
    "deleted": false,
    "created_at": "2024-01-18T12:57:42.813Z",
    "updated_at": "2024-01-18T12:57:42.813Z",
    "_id": "65a9204674cf43c7b43d0f9f",
    "__v": 0
  },
  "msg": "User created successfully"
}
```


For the User type Business, the following request body should be sent with the user_type parameter value 'business' and a valid email address.

### Request body

```json
{
  "first_name": "Somchai Anant",
  "country_code": "+66",
  "mobile_no": "655597453",
  "user_email": "somchai@gmail.com",
  "language": 1
}
```

Response header
```json
{
  "status": 200,
  "err": 0,
  "data": {
    "first_name": "Somchai Anant",
    "country_code": "+66",
    "mobile_no": "655597453",
    "user_email": "somchai@gmail.com",
    "user_type": 2,
    "skills": [],
    "notification": true,
    "open_to_work": false,
    "language": 1,
    "deleted": false,
    "created_at": "2024-01-19T04:35:07.124Z",
    "updated_at": "2024-01-19T04:35:07.124Z",
    "_id": "65a9fbfb53076bf0636d06d0",
    "__v": 0
  },
  "msg": "User created successfully"
}
```


If an invalid email address is entered, the following response will be received.

Response header
```json
{
  "status": 406,
  "err": 1,
  "data": {
    "errors": []
  },
  "msg": "Please enter valid email address"
}
```

If an invalid value for any key, whose value type does not match its schema data type, is entered, the response will be as follows.

Response header
```json
{
  "status": 200,
  "err": 0,
  "data": {},
  "msg": {
    "errors": {
      "language": {
        "stringValue": "\"abc\"",
        "valueType": "string",
        "kind": "Number",
        "value": "abc",
        "path": "language",
        "reason": {
          "generatedMessage": true,
          "code": "ERR_ASSERTION",
          "actual": false,
          "expected": true,
          "operator": "=="
        },
        "name": "CastError",
        "message": "Cast to Number failed for value \"abc\" (type string) at path \"language\""
      }
    },
    "_message": "user validation failed",
    "name": "ValidationError",
    "message": "user validation failed: language: Cast to Number failed for value \"abc\" (type string) at path \"language\""
  }
}
```


<!-- Login -->

# User Login API

## Endpoint

`POST /api/user/login`

This endpoint facilitates user login by requiring the user's country code and mobile number for authentication.

#### Parameters
- `country_code` (string, required): The country code of the user's phone number.
- `mobile_no` (string, required): The user's mobile number.

## Request

### Body

```json
{
  "country_code": "+66",
  "mobile_no": "655597453"
}
```

Response header
```json
{
    "status": 200,
    "err": 0,
    "data": {},
    "msg": "Otp sent to your mobile no"
}
```

If any invalid data enter, then below response will received.

```json
{
    "status": 406,
    "err": 1,
    "data": {
        "errors": [
            {
                "type": "field",
                "value": "655597453t",
                "msg": "Invalid value",
                "path": "mobile_no",
                "location": "body"
            }
        ]
    },
    "msg": "Please Enter All Fields"
}
```

#### Middleware
The endpoint utilizes a middleware function, loginMid, which performs input validation and invokes the user login process.

#### Validation
The middleware employs Express Validator to validate request parameters. Validation includes checking for empty values and ensuring numeric format for country code and mobile number.

#### Login Process
Input Validation:

Checks for validation errors using Express Validator.
If errors are found, returns a validation response.

#### User Authentication:

Validates the user's credentials using the userModel.

#### OTP Generation and Sending:

If the user is authenticated, generates and sends an OTP to the user's mobile number.

#### Error Handling:
Errors during the login process are appropriately handled, and detailed error messages are returned in the response.

#### Controller Functions:

loginMid(req: Request, res: Response)
Middleware function for user login, performing input validation and triggering the user login API.

#### login(data: any, callback: Function)
Controller function for user login based on the provided data. Handles validation, user authentication, and OTP generation.

#### User Model
The user model (userModel) is used to interact with the database for user authentication.

#### User Data Structure
The structure of the user data includes various fields such as first_name, country_code, mobile_no, user_email, etc.

This documentation provides an overview of the POST /api/user/login endpoint, including request parameters, body parameters, middleware, validation, login process, error handling, and relevant controller functions and models.



<!-- Verify OTP -->


# User Verification API

## Verify OTP

Endpoint to verify user identity using OTP.

### Request

- URL: `POST /api/user/verify-otp`

#### Request Body

```json
{
  "country_code": "+66",
  "mobile_no": "655597453t",
  "otp": 1234
}
```

Response header

```json
{
    "status": 200,
    "err": 0,
    "data": {},
    "msg": "Otp matched"
}
```
If wrong otp enterd, below response will received.

```json
{
    "status": 200,
    "err": 1,
    "data": {},
    "msg": "Invalid otp"
}
```

If wrong mobile no entered, below response will received.

```json
{
    "status": 200,
    "err": 1,
    "data": {},
    "msg": "OTP not generated for entered mobile no"
}
```