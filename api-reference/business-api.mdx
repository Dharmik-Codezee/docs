---
title: Business API
excludeFromToc: true
---


# Add Business API

## Endpoint

`POST /api/business/add`

This endpoint is used for add business, allowing the creation of different user types based on the user_type parameter.

### Request Parameters
#### Authorization Header
Valid Bearer type JWT token for authentication.

#### Body Parameters
- `owner_id` (Body parameter): Unique identifier of the business owner (minimum length: 24 characters).
- `business_name` (Body parameter): Name of the business.

Additional parameters as per the business creation requirements.

####  Middleware
This middleware function addBusinessMid is responsible for validating the incoming request for adding a new business. It checks the presence and format of required fields in the request body and ensures that the request is authenticated with a valid authorization header.

####  Validation
- Validates request parameters using express-validator.
- Checks for valid email format if business_email is provided.
- Responds with appropriate error messages if validation fails.

#### Add business Process

Controller function ADD_BUSINESS handles the business creation process. It validates user existence, owner existence, and ensures that the business name is unique. If all validations pass, it creates a new business and associates it with a location. Adress, city and zip_code is required to add atleast one location of business. 

### Request body

```json
{
    "owner_id": "65bc7b14bf1407cea573a9c6",
    "business_name": "Test Case Motel 3",
    "business_country_code": "+66",
    "business_mobile_no": "655597453",
    "business_email": "thai@gmail.com",
    "business_category_id": "65b8c331d3aa1143d135b72c",
    "business_details": "Thai food hotel",
    "logo": "images/photo.jpeg",
    "address": "101, Last Street",
    "city": "Bangkok, Thailand",
    "zip_code": "987654",
    "longitude": 100.9925,
    "latitude": 15.8700
}
```

### Response header
```json
{
    "status": 200,
    "err": 0,
    "data": {
        "owner_id": "65b0d318d14ea49e250c4818",
        "business_name": "Thai Hote",
        "business_country_code": "+66",
        "business_mobile_no": "655597453",
        "business_email": "thai@gmail.com",
        "business_category_id": "65b8c331d3aa1143d135b72c",
        "business_details": "Thai food hotel",
        "deleted": false,
        "created_by": "65b0d318d14ea49e250c4818",
        "updated_by": "65b0d318d14ea49e250c4818",
        "created_at": "2024-01-25T07:15:44.523Z",
        "updated_at": "2024-01-25T07:15:44.523Z",
        "_id": "65b20aa03e01620f97431c45",
        "__v": 0
    },
    "msg": "Business created successfully"
}
```
If business name already exist:

```json
{
    "status": 200,
    "err": 1,
    "data": {},
    "msg": "Business name already exist"
}
```

If owner of business not exist:

```json
{
    "status": 200,
    "err": 1,
    "data": {},
    "msg": "Owner not exist"
}
```

If user not exist:

```json
{
   "status": 401,
   "err": 1,
   "data": {},
   "msg": "User not exist"
}
```




# Add Location API

## Endpoint

`POST /api/business/add-location`

This endpoint is used to add a new location for a business.

### Request Headers
- `authorization` (Header): Authorization token for user authentication.

### Request Body Parameters
- `business_id` (Body parameter): The ID of the business. Should be a non-empty string with a minimum length of 24 characters.
- `address` (Body parameter): The address of the location. Should be a non-empty string.
- `city` (Body parameter): The city of the location. Should be a non-empty string.
- `zip_code` (Body parameter): The ZIP code of the location. Should be a non-empty string.

### Middleware
The endpoint utilizes a middleware function, `addLocationMid`, which performs input validation and invokes the location addition process.

### Validation
The middleware employs Express Validator to validate request headers and body data. Validation includes checking for empty values and ensuring the business ID meets the required length.

### Location Addition Process

#### Input Validation:
- Checks for validation errors using Express Validator.
- If errors are found, returns a validation response.

#### Authorization Decoding:
- Decodes the authorization token to retrieve user information.

#### Business Location Addition:
- Validates the user existence.
- Validates the business existence.
- Checks for existing business location.
- Adds a new business location if all conditions are met.

### Request body

```json
{
    "business_id": "65b0d9a2d98de3215b512534",
    "address": "100, First Street",
    "city": "Bangkok",
    "zip_code": "987654",
    "latitude": "13.7563째 N",
    "longitude": "100.5018째 E"
}
```

### Response header
```json
{
    "status": 200,
    "err": 0,
    "data": {
        "business_id": "65b0d9a2d98de3215b512534",
        "address": "100, First Street",
        "city": "Bangkok",
        "zip_code": "987654",
        "latitude": "13.7563째 N",
        "longitude": "100.5018째 E",
        "deleted": false,
        "created_by": "65b0d318d14ea49e250c4818",
        "updated_by": "65b0d318d14ea49e250c4818",
        "created_at": "2024-01-25T07:30:49.611Z",
        "updated_at": "2024-01-25T07:30:49.611Z",
        "_id": "65b20e293e01620f97431c58",
        "__v": 0
    },
    "msg": "Business Location added successfully"
}
```
If business location already exist:

```json
{
    "status": 200,
    "err": 1,
    "data": {},
    "msg": "Business location already exist"
}
```

If user not exist:

```json
{
   "status": 401,
   "err": 1,
   "data": {},
   "msg": "User not exist"
}
```

### Response
The API returns a JSON response with status, data, and message fields.

- Successful Response:
  - Status: 200
  - Data: Details of the added business location.
  - Message: "Business Location added successfully."

- Error Responses:
  - Validation Error:
    - Status: Corresponding HTTP status code
    - Data: Empty
    - Message: Details of the validation error.

  - User Not Exist Error:
    - Status: 401
    - Data: Empty
    - Message: "User not exist."

  - Business Not Exist Error:
    - Status: Corresponding HTTP status code
    - Data: Empty
    - Message: "Business not exist."

  - Business Location Exist Error:
    - Status: Corresponding HTTP status code
    - Data: Empty
    - Message: "Business location already exists."

  - Business Location Addition Error:
    - Status: Corresponding HTTP status code
    - Data: Empty
    - Message: "Business Location not added, please try again."




# Business List API

## Endpoint

`GET /api/business/list/:start/:limit`

This endpoint is used to retrieve a list of businesses associated with the authenticated user.

### Request Headers
- `authorization` (Header): Authorization token for user authentication.

### Request Parameters

- `start` (number): The starting index for pagination.
- `limit` (number): The maximum number of agents to fetch.

### Middleware
The endpoint utilizes a middleware function, `listBusinessMid`, which performs input validation and invokes the business listing process.

### Validation
The middleware employs Express Validator to validate request headers. Validation includes checking for empty values.

### Business Listing Process

#### Input Validation:
- Checks for validation errors using Express Validator.
- If errors are found, returns a validation response.

#### Authorization Decoding:
- Decodes the authorization token to retrieve user information.

#### Business Listing:
- Validates the user existence.
- Retrieves the list of businesses associated with the user, along with the latest location details for each business.

#### MongoDB Aggregation Pipeline:
- Uses MongoDB aggregation pipeline to fetch business details along with the latest location data.

### Response header
```json
{
    "status": 200,
    "err": 0,
    "data": [
        {
            "_id": "65b0d9a2d98de3215b512534",
            "owner_id": "65b0d318d14ea49e250c4818",
            "business_name": "Thai restaurant",
            "business_country_code": "+66",
            "business_mobile_no": "655597453",
            "business_email": "thai@gmail.com",
            "business_details": "Thai food restaurant",
            "deleted": false,
            "created_at": "2024-01-24T09:34:26.233Z",
            "logo": "images/photo.jpeg",
            "location": "Bangkok"
        },
        {
            "_id": "65b0d9b6d98de3215b512543",
            "owner_id": "65b0d318d14ea49e250c4818",
            "business_name": "Thai Hotel",
            "business_country_code": "+66",
            "business_mobile_no": "655597453",
            "business_email": "thai@gmail.com",
            "business_details": "Thai Food hotel",
            "deleted": false,
            "created_at": "2024-01-24T09:34:46.979Z",
            "logo": "images/photo.jpeg",
            "location": "Bangkok"
        }
    ],
    "msg": "Business list"
}
```
If no business exist of login user:

```json
{
    "status": 200,
    "err": 1,
    "data": [],
    "msg": "Please add atleast one business"
}
```

If user not exist:

```json
{
   "status": 401,
   "err": 1,
   "data": [],
   "msg": "User not exist"
}
```

#### Response
The API returns a JSON response with status, data, and message fields.

- Successful Response:
  - Status: 200
  - Data: List of businesses with their details.
  - Message: "Business list."

- Error Responses:
  - Validation Error:
    - Status: Corresponding HTTP status code
    - Data: Empty
    - Message: Details of the validation error.

  - User Not Exist Error:
    - Status: 401
    - Data: Empty
    - Message: "User not exist."

  - No Business Exist Error:
    - Status: Corresponding HTTP status code
    - Data: Empty
    - Message: "Please add at least one business."





# View Business API

## Endpoint

`GET /api/business/view/:business_id`

This endpoint is used to retrieve details of a specific business.

### Request Parameters
- `business_id` (URL parameter): The ID of the business to view. Should be a non-empty string with a minimum length of 24 characters.

### Request Headers
- `authorization` (Header): Authorization token for user authentication.

### Middleware
The endpoint utilizes middleware to validate request parameters and headers. The middleware function, `viewBusinessMid`, checks for validation errors and decodes the authorization token.

### Validation
The middleware employs Express Validator to validate the business ID parameter and authorization header. Validation includes checking for empty values and ensuring the business ID meets the required length.

### Business Viewing Process

#### Input Validation:
- Checks for validation errors using Express Validator.
- If errors are found, returns a validation response.

#### Authorization Decoding:
- Decodes the authorization token to retrieve user information.

#### Business Viewing:
- Validates the user existence.
- Retrieves details of the specified business, along with its location data.

#### MongoDB Aggregation Pipeline:
- Uses MongoDB aggregation pipeline to fetch business details along with associated location data.


### Response header
```json
{
    "status": 200,
    "err": 0,
    "data": {
        "_id": "65b0d9a2d98de3215b512534",
        "owner_id": "65b0d318d14ea49e250c4818",
        "business_name": "Thai restaurant",
        "business_country_code": "+66",
        "business_mobile_no": "655597453",
        "business_email": "thai@gmail.com",
        "business_details": "Thai food restaurant",
        "deleted": false,
        "created_at": "2024-01-24T09:34:26.233Z",
        "logo": "images/photo.jpeg",
        "locationData": [
            {
                "_id": "65b0d9a2d98de3215b512539",
                "address": "101, Main Street",
                "city": "Bangkok",
                "zip_code": "987654",
                "created_at": "2024-01-24T09:34:26.395Z"
            },
            {
                "_id": "65b0ddea4fb27e80cf4d9141",
                "address": "10, First Street",
                "city": "Bangkok",
                "zip_code": "987654",
                "created_at": "2024-01-24T09:52:42.370Z"
            }
        ]
    },
    "msg": "Business list"
}
```

If user not exist:

```json
{
   "status": 401,
   "err": 1,
   "data": {},
   "msg": "User not exist"
}
```

#### Response
The API returns a JSON response with status, data, and message fields.

- Successful Response:
  - Status: 200
  - Data: Details of the specified business, including location data.
  - Message: "Business details retrieved successfully."

- Error Responses:
  - Validation Error:
    - Status: Corresponding HTTP status code
    - Data: Empty
    - Message: Details of the validation error.

  - User Not Exist Error:
    - Status: 401
    - Data: Empty
    - Message: "User not exist."

  - Business Not Exist Error:
    - Status: Corresponding HTTP status code
    - Data: Empty
    - Message: "Business not exist."





# Update Business API

## Endpoint

`POST /api/business/update/:business_id`

This endpoint is used to update details of a specific business.

### Request Parameters
- `business_id` (URL parameter): The ID of the business to update. Should be a non-empty string with a minimum length of 24 characters.

### Request Headers
- `authorization` (Header): Authorization token for user authentication.

### Request Body Parameters
- `owner_id` (Body parameter): The ID of the business owner. Should be a non-empty string with a minimum length of 24 characters.
- `business_name` (Body parameter): The name of the business. Should be a non-empty string.
- `business_country_code` (Body parameter): The country code of the business.
- `business_mobile_no` (Body parameter): The mobile number of the business.
- `business_email` (Body parameter): The email address of the business.
- `business_details` (Body parameter): Additional details of the business.
- `deleted` (Body parameter): Flag indicating if the business is deleted.

### Middleware
The endpoint utilizes middleware to validate request parameters, headers, and perform additional email validation.

### Validation
The middleware employs Express Validator to validate the business ID parameter, authorization header, and owner ID. Validation includes checking for empty values, ensuring the business ID and owner ID meet the required length, and validating email format.

### Business Update Process

#### Input Validation:
- Checks for validation errors using Express Validator.
- Validates the email address format.
- If errors are found, returns a validation response.

#### Authorization Decoding:
- Decodes the authorization token to retrieve user information.

#### Business Owner Validation:
- Validates the existence of the business owner.

#### Business Update:
- Validates the user existence.
- Validates the business existence.
- Checks for existing business name.
- Updates the business details if all conditions are met.


### Request body

```json
{
    "owner_id": "65b0d318d14ea49e250c4818",
    "business_name": "Thai Hotel",
    "business_country_code": "+66",
    "business_mobile_no": "655597453",
    "business_email": "thai@gmail.com",
    "business_category_id": "65b8c331d3aa1143d135b72c",
    "business_details": "Thai Food hotel",
    "logo": "images/photo.jpeg",
    "address": "101, Main Street",
    "city": "Bangkok",
    "zip_code": "987654",
    "deleted": false
}
```

### Response header
```json
{
    "status": 200,
    "err": 0,
    "data": {
        "_id": "65b0d9b6d98de3215b512543",
        "owner_id": "65b0d318d14ea49e250c4818",
        "business_name": "Thai Hotel",
        "business_country_code": "+66",
        "business_mobile_no": "655597453",
        "business_email": "thai@gmail.com",
        "business_category_id": "65b8c331d3aa1143d135b72c",
        "business_details": "Thai Food hotel",
        "deleted": false,
        "created_by": "65b0d318d14ea49e250c4818",
        "updated_by": "65b0d318d14ea49e250c4818",
        "created_at": "2024-01-24T09:34:46.979Z",
        "updated_at": "2024-01-25T05:32:34.747Z",
        "__v": 0,
        "logo": "images/photo.jpeg"
    },
    "msg": "Business updated"
}
```

If user not exist:

```json
{
   "status": 401,
   "err": 1,
   "data": {},
   "msg": "User not exist"
}
```

#### Response
The API returns a JSON response with status, data, and message fields.

- Successful Response:
  - Status: 200
  - Data: Updated details of the business.
  - Message: "Business updated."

- Error Responses:
  - Validation Error:
    - Status: Corresponding HTTP status code
    - Data: Empty
    - Message: Details of the validation error.

  - User Not Exist Error:
    - Status: 401
    - Data: Empty
    - Message: "User not exist."

  - Owner Not Exist Error:
    - Status: Corresponding HTTP status code
    - Data: Empty
    - Message: "Owner not exist."

  - Business Name Exist Error:
    - Status: Corresponding HTTP status code
    - Data: Empty
    - Message: "Business name already exists."

  - Business Update Error:
    - Status: Corresponding HTTP status code
    - Data: Empty
    - Message: "Business not updated, please try again."







# Business Location List API

## Endpoint

`GET /api/business/list-location/:business_id`

This endpoint is used to fetch the list of locations associated with a specific business.

### Request Headers

- `Authorization`: Authorization header is required and must not be empty.

### Request Parameters

- `business_id` (URL parameter): Specifies the ID of the business for which to fetch the locations. It must be a valid business ID.

### Notes

- This API is used to fetch the list of locations associated with a specific business.
- The middleware listLocationMid handles authorization and request validation for this endpoint.
- The response includes details about each location such as address, city, zip code, coordinates, and location name.

### Middleware

This middleware function `listLocationMid` handles the request validation and authorization.

### Business Location List Process

The API checks the user's authorization, validates the business ID, and then fetches the list of locations associated with the specified business. The response includes details about each location such as address, city, zip code, coordinates, and location name.

### Success Response Example

```json
{
    "status": 200,
    "err": 0,
    "data": [
        {
            "_id": "65bc7b14bf1407cea573a9d9",
            "business_id": "65bc7b14bf1407cea573a9cc",
            "address": "101, Main Street",
            "city": "65bb44cdc384371c9b8f3376",
            "zip_code": "987654",
            "deleted": false,
            "location_name": "Bangkok, Thailand"
        }
    ],
    "msg": "The business location list has been successfully fetched."
}
```

If business not exist:

```json
{
    "status": 200,
    "err": 1,
    "data": [],
    "msg": "Business not exist"
}
```

If user not exist:

```json
{
   "status": 401,
   "err": 1,
   "data": [],
   "msg": "User not exist"
}
```

If business id field is empty

```json
{
    "status": 406,
    "err": 1,
    "data": {
        "errors": [
            {
                "type": "field",
                "value": ":business_id",
                "msg": "Please vaild business id",
                "path": "business_id",
                "location": "params"
            }
        ]
    },
    "msg": "Please Enter All Fields"
}
```






# Update Business Location API

## Endpoint

`POST /api/business/update-location/:location_id`

This endpoint is used to update details of a specific business location.

### Request Parameters
- `location_id` (URL parameter): The ID of the location to update. Should be a non-empty string with a minimum length of 24 characters.

### Request Headers
- `authorization` (Header): Authorization token for user authentication.

### Request Body Parameters
- `business_id` (Body parameter): The ID of the business. Should be a non-empty string with a minimum length of 24 characters.
- `address` (Body parameter): The address of the location. Should be a non-empty string.
- `city` (Body parameter): The city of the location. Should be a non-empty string.
- `zip_code` (Body parameter): The ZIP code of the location. Should be a non-empty string.
- `latitude` (Body parameter): The latitude of the location.
- `longitude` (Body parameter): The longitude of the location.
- `deleted` (Body parameter): Flag indicating if the location is deleted.

### Middleware
The endpoint utilizes middleware to validate request parameters, headers, and perform additional checks.

### Validation
The middleware employs Express Validator to validate the location ID parameter, authorization header, and business ID. Validation includes checking for empty values, ensuring the location ID and business ID meet the required length.

### Location Update Process

#### Input Validation:
- Checks for validation errors using Express Validator.
- If errors are found, returns a validation response.

#### Authorization Decoding:
- Decodes the authorization token to retrieve user information.

#### Business Existence Validation:
- Validates the existence of the business.

#### Business Location Update:
- Validates the user existence.
- Validates the business existence.
- Checks for existing business location.
- Updates the business location details if all conditions are met.


### Request body

```json
{
    "business_id": "65b0d9a2d98de3215b512534",
    "address": "100, First Street",
    "city": "Bangkok",
    "zip_code": "987654",
    "latitude": "13.7564째 N",
    "longitude": "100.5019째 E",
    "deleted": false
}
```

### Response header
```json
{
    "status": 200,
    "err": 0,
    "data": {
        "_id": "65b0ddea4fb27e80cf4d9141",
        "business_id": "65b0d9a2d98de3215b512534",
        "address": "100, First Street",
        "city": "Bangkok",
        "zip_code": "987654",
        "longitude": "100.5019째 E",
        "deleted": false,
        "created_by": "65b0d318d14ea49e250c4818",
        "updated_by": "65b0d318d14ea49e250c4818",
        "created_at": "2024-01-24T09:52:42.370Z",
        "updated_at": "2024-01-25T06:13:34.065Z",
        "__v": 0,
        "latitude": "13.7564째 N"
    },
    "msg": "Business location updated"
}
```

If user not exist:

```json
{
   "status": 401,
   "err": 1,
   "data": {},
   "msg": "User not exist"
}
```

#### Response
The API returns a JSON response with status, data, and message fields.

- Successful Response:
  - Status: 200
  - Data: Updated details of the business location.
  - Message: "Business location updated."

- Error Responses:
  - Validation Error:
    - Status: Corresponding HTTP status code
    - Data: Empty
    - Message: Details of the validation error.

  - User Not Exist Error:
    - Status: 401
    - Data: Empty
    - Message: "User not exist."

  - Business Not Exist Error:
    - Status: Corresponding HTTP status code
    - Data: Empty
    - Message: "Business not exist."

  - Business Location Exist Error:
    - Status: Corresponding HTTP status code
    - Data: Empty
    - Message: "Business location already exists."

  - Business Location Update Error:
    - Status: Corresponding HTTP status code
    - Data: Empty
    - Message: "Business location not updated, please try again."






# View Business Profile API

## Endpoint

`GET /api/business/profile/view/:business_id`

This endpoint is used to view the profile of a business.

### Request

#### Headers

- `authorization`: Authorization token.

#### Parameters

- `business_id`: The ID of the business whose profile is to be viewed.

### Response

- Status: 200 OK if successful, error status otherwise.
- Body: JSON response containing the profile data of the business.

### Validation

- The `authorization` header must be included in the request.
- The `business_id` parameter must be a valid MongoDB ObjectID with a length of 24 characters.

### Notes

- This endpoint retrieves the profile information of a business, including its basic details and location data.
- If the business profile is found, the response contains the profile data in the body.
- If the business profile is not found or the user is not authorized, appropriate error messages are returned in the response.

---

#### Example

### Response header

```json
{
    "status": 200,
    "err": 0,
    "data": {
        "_id": "65bc7b14bf1407cea573a9c6",
        "country_code": "+66",
        "mobile_no": "222222222",
        "first_name": "Test Business Owner",
        "user_email": "owner@gmail.com",
        "user_type": 2,
        "language": 1,
        "locationData": [
            {
                "_id": "65bc7b14bf1407cea573a9d9",
                "business_id": "65bc7b14bf1407cea573a9cc",
                "address": "101, Main Street",
                "city": "Bangkok, Thailand",
                "zip_code": "987654"
            }
        ],
        "owner_id": "65bc7b14bf1407cea573a9c6",
        "logo": "images/photo.jpeg",
        "business_name": "Test Thai Hotel",
        "business_country_code": "+66",
        "business_mobile_no": "655597453",
        "business_email": "thai@gmail.com",
        "business_category_id": "65b8c331d3aa1143d135b72c",
        "business_details": "Thai food hotel"
    },
    "msg": "Profile data"
}
```

Error Response Example

```json
{
  "status": 400,
  "error": {
    "message": "Validation error",
    "details": ["Please enter a valid mobile number"]
  }
}
```




# Update Business Profile API

## Endpoint

`PATCH /api/business/profile/update/:business_id`

This endpoint is used to update the profile of a business.

### Request

#### Headers

- `authorization`: Authorization token.

#### Parameters

- `business_id`: The ID of the business whose profile is to be updated.

### Body

- `logo`: URL of the business logo.
- `business_name`: Name of the business.
- `business_email`: Email address of the business.
- `business_category_id`: ID of the business category.
- `business_details`: Details about the business.
- `first_name`: First name of the user associated with the business.
- `user_email`: Email address of the user associated with the business.
- `language`: Preferred language of the user associated with the business.

### Response

- Status: 200 OK if successful, error status otherwise.
- Body: JSON response containing the updated profile data of the business.

### Validation

- The `authorization` header must be included in the request.
- The `business_id` parameter must be a valid MongoDB ObjectID with a length of 24 characters.
- The `business_category_id` must be a valid MongoDB ObjectID if provided.
- The `logo`, `business_email`, and `user_email` fields must contain valid email addresses if provided.
- The `language` field must be a number.

### Notes

- This endpoint updates the profile information of a business, including its basic details and category.
- Only authorized users who are members of the business can update the profile.
- If the business profile is not found, or the user is not authorized, appropriate error messages are returned in the response.

---

### Examples

#### Request Example

```json
{
    "first_name": "Test Business Owner",
    "user_email": "owner@gmail.com",
    "language": 1,
    "logo": "images/photo.jpeg",
    "business_name": "Test Thai Hotel",
    "business_email": "thai@gmail.com",
    "business_category_id": "65b8c331d3aa1143d135b72c",
    "business_details": "Test Food Hotel"
}
```

Successful Response Example

```json
{
    "status": 200,
    "err": 0,
    "data": {
        "_id": "65bc7b14bf1407cea573a9cc",
        "country_code": "+66",
        "mobile_no": "222222222",
        "first_name": "Test Business Owner",
        "user_email": "owner@gmail.com",
        "user_type": 2,
        "language": 1,
        "owner_id": "65bc7b14bf1407cea573a9c6",
        "logo": "images/photo.jpeg",
        "business_name": "Test Thai Hotel",
        "business_country_code": "+66",
        "business_mobile_no": "655597453",
        "business_email": "thai@gmail.com",
        "business_category_id": "65b8c331d3aa1143d135b72c",
        "business_details": "Test Food Hotel",
        "notification": true,
        "created_by": "65bc7b14bf1407cea573a9c6",
        "updated_by": "65bc7b14bf1407cea573a9c6"
    },
    "msg": "Profile detail updated"
}
```
Error Response Example

```json
{
  "status": 400,
  "error": {
    "message": "Validation error",
    "details": ["Please enter a valid mobile number"]
  }
}
```




# Send OTP for Business Mobile Number Verification API

## Endpoint

`POST /api/business/mobile/send-otp/:business_id`

This endpoint is used to send an OTP to the mobile number associated with a business for verification purposes.

### Request

#### Headers

- `authorization`: Authorization token.

#### Parameters

- `business_id` (required): The ID of the business for which the OTP is being sent.

### Response

- Status: 200 OK if the OTP is successfully sent, error status otherwise.
- Body: JSON response indicating the result of the OTP sending operation.

### Validation

- The `authorization` header must be included in the request.
- The `business_id` parameter must be provided in the URL and should be a valid MongoDB ObjectID with a length of 24 characters.

### Notes

- This endpoint sends an OTP to the mobile number associated with a business for verification purposes.
- The OTP is sent only if the user making the request is a member of the business.
- If the business does not exist or if the user is not a member of the business, appropriate error messages are returned in the response.

---

### Success Response (200 OK)

```json
{
    "status": 200,
    "err": 0,
    "data": {},
    "msg": "Otp sent to business mobile no"
}
```

### Error Response (User Not Exist)

```json
{
  "status": 401,
  "err": 1,
  "data": {},
  "msg": "User not exist"
}
```

### Error Response (If token is expired):

```json
{
  "status": 401,
  "err": 1,
  "data": {},
  "msg": "Token Expired"
}
```




# Verify OTP for Business Mobile Number API

## Endpoint

`POST /api/business/mobile/verify-otp/:business_id`

This endpoint is used to verify the OTP sent to the mobile number associated with a business.

### Request

#### Headers

- `authorization`: Authorization token.

#### Parameters

- `business_id` (required): The ID of the business for which the OTP is being verified.

#### Body

- `otp` (required): The OTP to be verified.

### Response

- Status: 200 OK if the OTP is successfully verified, error status otherwise.
- Body: JSON response indicating the result of the OTP verification operation.

### Validation

- The `authorization` header must be included in the request.
- The `business_id` parameter must be provided in the URL and should be a valid MongoDB ObjectID with a length of 24 characters.
- The `otp` parameter must be provided in the request body and should be a numeric value.

### Notes

- This endpoint verifies the OTP sent to the mobile number associated with a business.
- The OTP is verified only if the user making the request is a member of the business.
- If the business does not exist, if the user is not a member of the business, or if the OTP is invalid or not found, appropriate error messages are returned in the response.

---
### Example
### Request Body

```json
{
    "otp": 1234
}
```

### Success Response (200 OK)

```json
{
    "status": 200,
    "err": 0,
    "data": {},
    "msg": "OTP verified"
}
```

### Error Response (User Not Exist)

```json
{
  "status": 401,
  "err": 1,
  "data": {},
  "msg": "User not exist"
}
```

### Error Response (If token is expired):

```json
{
  "status": 401,
  "err": 1,
  "data": {},
  "msg": "Token Expired"
}
```




# Send OTP to Update Business Mobile Number API

## Endpoint

`POST /api/business/update-mobile/send-otp/:business_id`

This endpoint is used to send an OTP to verify the update of the mobile number associated with a business.

### Request

#### Headers

- `authorization`: Authorization token.

#### Parameters

- `business_id` (required): The ID of the business for which the OTP is being sent.

#### Body

- `country_code` (required): The country code of the new mobile number.
- `mobile_no` (required): The new mobile number.
- `otp` (required): The OTP to be sent and verified.

### Response

- Status: 200 OK if the OTP is successfully sent, error status otherwise.
- Body: JSON response indicating the result of the OTP sending operation.

### Validation

- The `authorization` header must be included in the request.
- The `business_id` parameter must be provided in the URL and should be a valid MongoDB ObjectID with a length of 24 characters.
- The `country_code`, `mobile_no`, and `otp` parameters must be provided in the request body. `country_code` and `mobile_no` should be numeric values, and `otp` should be a numeric value.

### Notes

- This endpoint sends an OTP to the specified mobile number to verify the update of the mobile number associated with a business.
- The OTP is sent only if the user making the request is a member of the business.
- If the business does not exist or if the user is not a member of the business, appropriate error messages are returned in the response.

---
### Example
### Request Body

```json
{
    "country_code": "+66",
    "mobile_no": 222222223,
    "otp": 1234
}
```

### Success Response (200 OK)

```json
{
    "status": 200,
    "err": 0,
    "data": {},
    "msg": "Otp sent to your entered mobile no"
}
```

### Error Response (User Not Exist)

```json
{
  "status": 401,
  "err": 1,
  "data": {},
  "msg": "User not exist"
}
```

### Error Response (If token is expired):

```json
{
  "status": 401,
  "err": 1,
  "data": {},
  "msg": "Token Expired"
}
```




# Verify OTP to Update Business Mobile Number API

## Endpoint

`POST /api/business/update-mobile/verify-otp/:business_id`

This endpoint is used to verify the OTP sent for updating the mobile number associated with a business.

### Request

#### Headers

- `authorization`: Authorization token.

#### Parameters

- `business_id` (required): The ID of the business for which the OTP is being verified.

#### Body

- `country_code` (required): The country code of the new mobile number.
- `mobile_no` (required): The new mobile number.
- `otp` (required): The OTP to be verified.

### Response

- Status: 200 OK if the OTP is successfully verified and the mobile number is updated, error status otherwise.
- Body: JSON response indicating the result of the OTP verification operation.

### Validation

- The `authorization` header must be included in the request.
- The `business_id` parameter must be provided in the URL and should be a valid MongoDB ObjectID with a length of 24 characters.
- The `country_code`, `mobile_no`, and `otp` parameters must be provided in the request body. `country_code` and `mobile_no` should be numeric values, and `otp` should be a numeric value.

### Notes

- This endpoint verifies the OTP sent for updating the mobile number associated with a business.
- The mobile number is updated only if the user making the request is a member of the business and the OTP is valid.
- If the business does not exist, the user is not a member of the business, or the OTP is invalid, appropriate error messages are returned in the response.

---
### Example
### Request Body

```json
{
    "country_code": "+66",
    "mobile_no": 222222223,
    "otp": 4321
}
```

### Success Response (200 OK)

```json
{
    "status": 200,
    "err": 0,
    "data": {
        "_id": "65bc8b03ee10fd14593b0cfb",
        "owner_id": "65bc7b14bf1407cea573a9c6",
        "logo": "images/photo.jpeg",
        "business_name": "Thai Bar",
        "business_country_code": "+66",
        "business_mobile_no": "222222223",
        "business_email": "thai@gmail.com",
        "business_category_id": "65b8c331d3aa1143d135b72c",
        "business_details": "Thai Food hotel",
        "notification": true,
        "deleted": false,
        "created_by": "65bc7b14bf1407cea573a9c6",
        "updated_by": "65bc7b14bf1407cea573a9c6",
        "created_at": "2024-02-02T06:26:11.206Z",
        "updated_at": "2024-02-02T06:39:39.447Z",
        "__v": 0
    },
    "msg": "Mobile no updated"
}
```

### Error Response (User Not Exist)

```json
{
  "status": 401,
  "err": 1,
  "data": {},
  "msg": "User not exist"
}
```

### Error Response (If token is expired):

```json
{
  "status": 401,
  "err": 1,
  "data": {},
  "msg": "Token Expired"
}
```





# Business Invite Jobseeker Detail API

## Endpoint

`GET /api/business/invite-jobseeker-detail/:business_id/:jobseeker_id`

This endpoint retrieves detailed information about a jobseeker who has been invited by a business.

### Request

- Headers
  - `authorization`: Authorization token for the authenticated user.

- Parameters
  - `business_id`: Unique identifier for the business.
  - `jobseeker_id`: Unique identifier for the jobseeker.

### Response

- Status: 200 OK if the operation is successful, error status otherwise.
- Body: JSON response containing detailed information about the jobseeker and the jobs they have applied to.
  - The response includes various details about the jobseeker, such as their personal information, work experience, education, certificates, and applied jobs.
  - Each applied job includes details such as job ID, title, experience required, workplace type, job type, salary, description, description image, business name, business logo, and location name.

### Notes

- This endpoint allows businesses to retrieve detailed information about a specific jobseeker they have invited.
- The API performs authorization to ensure that only authenticated users with appropriate permissions can access the jobseeker details.
- If the specified business or jobseeker is not found, appropriate error messages are returned in the response.

---

### Success Response (200 OK)

```json
{
    "status": 200,
    "err": 0,
    "data": {
        "_id": "65c9b66029033adf0860f8f9",
        "country_code": "+66",
        "mobile_no": "888888888",
        "first_name": "Test Case Job",
        "last_name": "Test Case Seeker",
        "user_email": "owner@gmail.com",
        "user_type": 1,
        "language": 1,
        "deleted": false,
        "employmentData": [
            {
                "_id": "65c9b8adb1daa6a292a7e3df",
                "currently_employed": false,
                "job_title": "Test Case Software Engineer",
                "company_name": "Test Case ABC Inc.",
                "work_from": "2019-01-01T00:00:00.000Z",
                "work_to": "2019-05-23T00:00:00.000Z",
                "exp_year": 0,
                "exp_month": 4,
                "work_description": "Working on web development projects"
            }
        ],
        "educationData": [
            {
                "_id": "65c9b77c58f72def2dcdb76f",
                "education_type": 2,
                "institute": "VNSG",
                "course": "B",
                "specialization": "Gujarat",
                "duration_from": "2020-06-15T00:00:00.000Z",
                "duration_to": "2023-04-10T00:00:00.000Z",
                "grading": "89"
            }
        ],
        "certificateData": [
            {
                "_id": "65c9b781b005784000ca60c5",
                "certificate_name": "Degree_1",
                "file_url": "images/certificate.text"
            },
            {
                "_id": "65c9b8b21ed6eb1189a501f9",
                "certificate_name": "Degree_3",
                "file_url": "images/certificate.text"
            },
            {
                "_id": "65c9bf096c1ae41140b4aa01",
                "certificate_name": "Degree_2",
                "file_url": "images/certificate.text"
            }
        ],
        "full_name": "Test Case Job Test Case Seeker",
        "date_of_birth": "1995-11-25T00:00:00.000Z",
        "about": "I am Jobseeker",
        "gender": 1,
        "location": "65bb44cdc384371c9b8f3376",
        "location_name": "Bangkok, Thailand",
        "work_position": "Supervisor",
        "work_status": 2,
        "profile_img": "1706529737205_eb411d0102e4a8d022362810cbbcd1cd.jpeg",
        "identity_type": 1,
        "identity_card": "images/id_card.jpeg",
        "skills": [
            "Supervision",
            "Data analysis",
            "Management"
        ],
        "known_language": [
            "Gujarati",
            "English",
            "Thai"
        ],
        "resume": "valid_resume_data",
        "open_to_work": true,
        "available_to_join": 2,
        "appiedJobData": [
            {
                "_id": "65bc9a4f31e4bb6a9aed7d5b",
                "job_title": "Test Case Manager",
                "experience": 1,
                "workplace_type": 1,
                "job_type": 1,
                "salary": 30,
                "description": "Lorem ipsum dolor sit amet.",
                "description_img": "images/photo.jpeg",
                "business_name": "Thai Bar",
                "business_logo": "images/photo.jpeg"
            },
            {
                "_id": "65bc9ab731e4bb6a9aed7d63",
                "job_title": "Test General Manager",
                "experience": 1,
                "workplace_type": 1,
                "job_type": 1,
                "salary": 0,
                "description": "Lorem ipsum dolor sit amet.",
                "description_img": "images/photo.jpeg",
                "business_name": "Thai Bar",
                "business_logo": "images/photo.jpeg"
            }
        ]
    },
    "msg": "Applicant information."
}
```

### Error Response (User Not Exist)

```json
{
  "status": 401,
  "err": 1,
  "data": {},
  "msg": "User not exist"
}
```

If jobseeker data not found:

```json
{
  "status": 401,
  "err": 1,
  "data": {},
  "msg": "No applicant data found."
}
```




# Business Invite Jobseeker API

## Endpoint

`POST /api/business/jobseeker/invite/:job_id/:jobseeker_id`

This endpoint allows a business to invite a jobseeker to apply for a specific job.

### Request

- Headers
  - `authorization`: Authorization token for the authenticated user.

- Parameters
  - `job_id`: Unique identifier for the job.
  - `jobseeker_id`: Unique identifier for the jobseeker.

### Response

- Status: 200 OK if the operation is successful, error status otherwise.
- Body: JSON response containing information about the invitation status.
  - If the invitation is successful, the response includes details about the invitation, such as the job ID, jobseeker ID, status, creation and update timestamps, etc.
  - If the invitation fails, appropriate error messages are returned in the response.

### Notes

- This endpoint allows businesses to send invitations to jobseekers for specific job openings.
- The API performs validation to ensure that the provided job ID and jobseeker ID are valid and that the user making the request has appropriate permissions.
- If the specified job or jobseeker is not found, or if the jobseeker has already applied for the job or has already been invited, appropriate error messages are returned in the response.

---
### Success Response (200 OK)

```json
{
    "status": 200,
    "err": 0,
    "data": {
        "user_id": "65c9b66029033adf0860f8f9",
        "job_id": "65bcc00f2214cb459d0f0ade",
        "status": 1,
        "deleted": false,
        "created_by": "65bc7b14bf1407cea573a9c6",
        "updated_by": "65bc7b14bf1407cea573a9c6",
        "created_at": "2024-02-27T11:00:21.018Z",
        "updated_at": "2024-02-27T11:00:21.018Z",
        "_id": "65ddc0c5cdc73f7ae98e7b4c",
        "__v": 0
    },
    "msg": "Invitation sent successfully."
}
```

### Error Response (User Not Exist)

```json
{
  "status": 401,
  "err": 1,
  "data": {},
  "msg": "User not exist"
}
```

If invitation already sent:

```json
{
  "status": 401,
  "err": 1,
  "data": {},
  "msg": "The job has already been applied for."
}
```





# List Notifications API

## Endpoint

`GET /api/business/notification/list/:business_id/:start/:limit`

This endpoint retrieves a list of notifications for a specific business.

### Request

- Headers
  - `authorization`: Authorization token for the authenticated user.

- Params
  - `business_id`: The ID of the business for which notifications are requested.
  - `start`: The index of the first notification to retrieve.
  - `limit`: The maximum number of notifications to retrieve.

### Response

- Status: 200 OK if the operation is successful, error status otherwise.
- Body: JSON response containing the list of notifications.
  - If notifications are found, the response includes details such as the total number of unread notifications, total notifications, and the list of notifications within the specified range.
  - If no notifications are found, an appropriate message indicating an empty list is returned in the response body.

### Notes

- This endpoint requires authentication via the `authorization` header.
- The `business_id` parameter specifies the ID of the business for which notifications are to be retrieved. It must be a valid MongoDB ObjectID.
- The `start` parameter indicates the index of the first notification to retrieve, and `limit` specifies the maximum number of notifications to return.
- The API checks if the authenticated user has permission to access notifications for the specified business.
- It retrieves notifications based on the business ID and filters out any deleted notifications.
- The response includes the total number of unread notifications, total notifications, and a list of notifications within the specified range.
- Proper error handling is implemented to handle scenarios such as unauthorized access, invalid input, or database errors.

---
### Success Response (200 OK)

```json
{
    "status": 200,
    "err": 0,
    "data": {
        "total_unread_notification": 0,
        "total_notification": 1,
        "notification_list": [
            {
                "_id": "65e6bb7c06a63969a5ccfb1d",
                "notification_for": "65bc8b03ee10fd14593b0cfb",
                "notification_type": 1,
                "title": "Setting updated",
                "icon_type": 1,
                "message": "Notifcation status changed.",
                "is_read": true,
                "deleted": false,
                "created_by": "65bc7b14bf1407cea573a9c6",
                "updated_by": "65bc7b14bf1407cea573a9c6",
                "deleted_by": "65bc7b14bf1407cea573a9c6",
                "created_at": "2024-03-05T06:28:12.861Z",
                "updated_at": "2024-03-05T06:28:12.861Z",
                "__v": 0
            }
        ]
    },
    "msg": "The notification list has been successfully retrieved."
}
```

### Error Response (User Not Exist)

```json
{
  "status": 401,
  "err": 1,
  "data": {},
  "msg": "User not exist"
}
```

If business id not provide in param:

```json
{
    "status": 406,
    "err": 1,
    "data": {
        "errors": [
            {
                "type": "field",
                "value": ":business_id",
                "msg": "Please vaild business id",
                "path": "business_id",
                "location": "params"
            }
        ]
    },
    "msg": "Please Enter All Fields"
}
```





# Business Dashboard Count API

## Endpoint

`GET /api/business/dashboard-count/:business_id`

This endpoint retrieves various counts and statistics for a business dashboard.

### Request

- Headers
  - `authorization`: Authorization token for the authenticated user.

- Params
  - `business_id`: The ID of the business for which dashboard counts are requested.

### Response

- Status: 200 OK if the operation is successful, error status otherwise.
- Body: JSON response containing the counts and statistics for the business dashboard.
  - The response includes counts for:
    - Shortlisted applicants.
    - Rejected applicants.
    - Applications received today.
    - Profile completion percentage.
    - Number of unread notifications.
  - If successful, the response provides detailed data for each count.
  - If an error occurs or the requested data is not found, an appropriate error message is returned in the response body.

### Notes

- This endpoint requires authentication via the `authorization` header.
- The `business_id` parameter specifies the ID of the business for which dashboard counts are to be retrieved. It must be a valid MongoDB ObjectID.
- The API fetches counts for various metrics such as shortlisted applicants, rejected applicants, today's application count, profile completion percentage, and unread notification count.
- Internal API calls are made to retrieve the necessary data for each count, including shortlisted applicants, rejected applicants, today's application count, profile completion percentage, and unread notification count.
- Proper error handling is implemented to handle scenarios such as unauthorized access, invalid input, or database errors.

---
### Success Response (200 OK)

```json
{
    "status": 200,
    "err": 0,
    "data": {
        "shortlisted_count": 2,
        "rejected_count": 1,
        "today_application_count": 0,
        "profile_percent": 100,
        "notification_count": 0
    },
    "msg": "Please find dashboard data."
}
```

### Error Response (User Not Exist)

```json
{
  "status": 401,
  "err": 1,
  "data": {},
  "msg": "User not exist"
}
```

If business id not provide in param:

```json
{
    "status": 406,
    "err": 1,
    "data": {
        "errors": [
            {
                "type": "field",
                "value": ":business_id",
                "msg": "Please vaild business id",
                "path": "business_id",
                "location": "params"
            }
        ]
    },
    "msg": "Please Enter All Fields"
}
```




# Business Dashboard Banner API

## Endpoint

`GET /api/business/dashboard-banner/:business_id`

This endpoint retrieves a list of banners for display on the business dashboard.

### Request

- Headers
  - `authorization`: Authorization token for the authenticated user.

- Params
  - `business_id`: The ID of the business for which banners are requested.

### Response

- Status: 200 OK if the operation is successful, error status otherwise.
- Body: JSON response containing the list of banners.
  - The response includes an array of banner objects.
  - Each banner object contains information such as banner ID, banner path, visibility status, creation date, etc.
  - If successful, the response provides the list of banners.
  - If no banners are found, an empty array is returned in the response body.

### Notes

- This endpoint requires authentication via the `authorization` header.
- The `business_id` parameter specifies the ID of the business for which banners are to be retrieved. It must be a valid MongoDB ObjectID.
- Banners are randomly sampled from the database, with a maximum of 5 banners returned in the response.
- Proper error handling is implemented to handle scenarios such as unauthorized access, invalid input, or database errors.

---

### Success Response (200 OK)

```json
{
    "status": 200,
    "err": 0,
    "data": [
        {
            "_id": "65e571df047020336ebd528a",
            "banner_by": "65bc7b14bf1407cea573a9cc",
            "banner_path": "1709535711587_Snake_River_(5mb).jpeg",
            "deleted": false,
            "created_by": "65bc7b14bf1407cea573a9c6",
            "updated_by": "65bc7b14bf1407cea573a9c6",
            "deleted_by": "65bc7b14bf1407cea573a9c6",
            "created_at": "2024-03-04T07:01:51.674Z",
            "updated_at": "2024-03-04T07:01:51.674Z",
            "__v": 0,
            "is_visible": true
        },
        {
            "_id": "65e841899cfd51c8c4e58d64",
            "banner_by": "65d3013054a70c5740dcca9d",
            "banner_path": "1709719945736_image_cropper_609F8766-8442-4A6B-A05A-A817A91AA5FC-2605-000015FE7A46D801.jpg",
            "is_visible": true,
            "banner_type": 2,
            "deleted": false,
            "created_by": "65d3013054a70c5740dcca97",
            "updated_by": "65d3013054a70c5740dcca97",
            "deleted_by": "65d3013054a70c5740dcca97",
            "created_at": "2024-03-06T10:12:25.774Z",
            "updated_at": "2024-03-06T10:12:25.774Z",
            "__v": 0
        },
        {
            "_id": "65e56b70bc9fee05b484e001",
            "banner_by": "65bc7b14bf1407cea573a9cc",
            "banner_path": "1709534064693_Snake_River_(5mb).jpeg",
            "deleted": false,
            "created_by": "65bc7b14bf1407cea573a9c6",
            "updated_by": "65bc7b14bf1407cea573a9c6",
            "deleted_by": "65bc7b14bf1407cea573a9c6",
            "created_at": "2024-03-04T06:34:24.857Z",
            "updated_at": "2024-03-04T06:34:24.857Z",
            "__v": 0,
            "is_visible": true
        },
        {
            "_id": "65e56c3c6f0be6c7fe43b9ee",
            "banner_by": "65bc7b14bf1407cea573a9cc",
            "banner_path": "1709534268661_Snake_River_(5mb).jpeg",
            "deleted": false,
            "created_by": "65bc7b14bf1407cea573a9c6",
            "updated_by": "65bc7b14bf1407cea573a9c6",
            "deleted_by": "65bc7b14bf1407cea573a9c6",
            "created_at": "2024-03-04T06:37:48.817Z",
            "updated_at": "2024-03-04T06:37:48.817Z",
            "__v": 0,
            "is_visible": true
        },
        {
            "_id": "65e83d463d19dd9d8f03686c",
            "banner_by": "65d3013054a70c5740dcca9d",
            "banner_path": "1709718854024_i8AF9.jpg",
            "is_visible": true,
            "banner_type": 2,
            "deleted": false,
            "created_by": "65d3013054a70c5740dcca97",
            "updated_by": "65d3013054a70c5740dcca97",
            "deleted_by": "65d3013054a70c5740dcca97",
            "created_at": "2024-03-06T09:54:14.047Z",
            "updated_at": "2024-03-06T09:54:14.047Z",
            "__v": 0
        }
    ],
    "msg": "Here is the list of banners currently available."
}
```

### Error Response (User Not Exist)

```json
{
  "status": 401,
  "err": 1,
  "data": {},
  "msg": "User not exist"
}
```

If business id not provide in param:

```json
{
    "status": 406,
    "err": 1,
    "data": {
        "errors": [
            {
                "type": "field",
                "value": ":business_id",
                "msg": "Please vaild business id",
                "path": "business_id",
                "location": "params"
            }
        ]
    },
    "msg": "Please Enter All Fields"
}
```





# Business Notification Status API

## Endpoint

`GET /api/business/notification/status/:business_id/:notification_id`

This endpoint updates the status of a notification for a specific business, marking it as read.

### Request

- Headers
  - `authorization`: Authorization token for the authenticated user.

- Params
  - `business_id`: The ID of the business to which the notification belongs.
  - `notification_id`: The ID of the notification whose status is to be updated.

### Response

- Status: 200 OK if the operation is successful, error status otherwise.
- Body: JSON response containing the updated notification object.
  - The response includes the updated notification object with the `is_read` field set to `true`.
  - If the notification was already marked as read, an appropriate error message is returned.
  - If the provided IDs are invalid or the notification does not belong to the specified business, appropriate error messages are returned.

### Notes

- This endpoint requires authentication via the `authorization` header.
- Both `business_id` and `notification_id` parameters must be valid MongoDB ObjectIDs with a minimum length of 24 characters.
- The endpoint checks if the notification exists and belongs to the specified business before updating its status.
- If the notification is successfully updated, the response includes the updated notification object.
- Proper error handling is implemented to handle scenarios such as unauthorized access, invalid input, or database errors.

---

### Success Response (200 OK)

```json
{
    "status": 200,
    "err": 0,
    "data": {},
    "msg": "The notification has been successfully marked as read."
}
```

### Error Response (User Not Exist)

```json
{
  "status": 401,
  "err": 1,
  "data": {},
  "msg": "User not exist"
}
```

If notification already mark as read:

```json
{
    "status": 200,
    "err": 1,
    "data": {},
    "msg": "The notification has already been marked as read."
}
```





# View Agent API

## Endpoint

`GET /api/business/agent/view/:agent_id`

This endpoint retrieves details of a specific agent by their agent ID.

### Request

- Headers
  - `authorization`: Authorization token for the authenticated user.
- Parameters
  - `agent_id`: Specifies the agent's ID. It should be a string of length 24 characters.

### Response

- Status: 
  - 200 OK if the operation is successful.
  - Error status codes for failures (e.g., 401 for unauthorized access).
- Body: JSON response containing the agent's details or error message.
  - If the agent is found and details are retrieved successfully, the response includes the agent's information.
  - If the agent is not found or an error occurs during retrieval, an error message is returned.

### Notes

- Authentication is required via the `authorization` header.
- The `agent_id` parameter is used to specify which agent's details to fetch.
- Successful responses include the agent's details such as name, contact information, and bio.
- Error messages are returned for scenarios like the agent not existing, unauthorized access, or internal server errors.

### Success Response (200 OK)

```json
{
    "status": 200,
    "err": 0,
    "data": {
        "_id": "65efe525f5dae1ed2a2fed26",
        "country_code": "+66",
        "mobile_no": "444444441",
        "first_name": "Agent_1",
        "user_email": "agent_1@gmail.com",
        "user_type": 4,
        "language": 1,
        "deleted": false,
        "created_at": "2024-03-12T05:16:21.240Z",
        "updated_at": "2024-03-12T05:16:21.240Z",
        "__v": 0,
        "about_agent": "I am JobNow agent"
    },
    "msg": "Here are the details of the agent."
}
```

### Error Response (User Not Exist)

```json
{
  "status": 401,
  "err": 1,
  "data": {},
  "msg": "User not exist"
}
```

### If agent id not provide in param:

```json
{
    "status": 406,
    "err": 1,
    "data": {
        "errors": [
            {
                "type": "field",
                "value": ":agent_id",
                "msg": "Please vaild agent_id",
                "path": "agent_id",
                "location": "params"
            }
        ]
    },
    "msg": "Please Enter All Fields"
}
```
### If agent id is wrong

```json
{
    "status": 200,
    "err": 1,
    "data": {},
    "msg": "Sorry, the agent does not exist."
}
```





# Invite Agent API

## Endpoint

`GET /api/business/agent/invite/:business_id/:agent_id`

This endpoint sends an invitation to an agent to join a specific business.

### Request

- Headers
  - `authorization`: Authorization token for the authenticated user.

- Parameters
  - `business_id`: Specifies the business ID. Should be a string of length 24 characters.
  - `agent_id`: Specifies the agent's ID. Should be a string of length 24 characters.

### Response

- Status:
  - 200 OK if the invitation is sent successfully.
  - Error status codes for failures (e.g., 401 for unauthorized access).

- Body: JSON response indicating the result of the invitation attempt.
  - If the invitation is sent successfully, a success message is returned along with relevant data.
  - If the invitation fails (e.g., due to user not existing, business not existing, permission errors, etc.), an error message is returned.

### Notes

- Authentication is required via the `authorization` header.
- The `business_id` parameter specifies the ID of the business to which the agent is invited.
- The `agent_id` parameter specifies the ID of the agent being invited.
- Various checks are performed during the invitation process, such as user existence, business existence, permission checks, and previous invitation checks.
- Notifications are sent to the invited agent using Firebase Cloud Messaging (FCM) tokens.
- Error messages are returned for scenarios like user not existing, business not existing, permission errors, notification errors, etc.

---

### Success Response (200 OK)

```json
{
    "status": 200,
    "err": 0,
    "data": {
        "user_id": "65efe5ccf5dae1ed2a2fed2d",
        "business_id": "65bc8b03ee10fd14593b0cfb",
        "status": 1,
        "invitation_by": 2,
        "deleted": false,
        "created_by": "65bc7b14bf1407cea573a9c6",
        "updated_by": "65bc7b14bf1407cea573a9c6",
        "created_at": "2024-03-18T10:34:19.673Z",
        "updated_at": "2024-03-18T10:34:19.673Z",
        "_id": "65f818abca50493e1f05fafe",
        "__v": 0
    },
    "msg": "Invitation sent successfully."
}
```

### Error Response (User Not Exist)

```json
{
  "status": 401,
  "err": 1,
  "data": {},
  "msg": "User not exist"
}
```

### If business id and agent id not provide in param:

```json
{
    "status": 406,
    "err": 1,
    "data": {
        "errors": [
            {
                "type": "field",
                "value": ":business_id",
                "msg": "Please vaild business id",
                "path": "business_id",
                "location": "params"
            },
            {
                "type": "field",
                "value": ":agent_id",
                "msg": "Please vaild agent id",
                "path": "agent_id",
                "location": "params"
            }
        ]
    },
    "msg": "Please Enter All Fields"
}
```

### If agent id is not valid

```json
{
    "status": 200,
    "err": 1,
    "data": {},
    "msg": "Sorry, the agent does not exist."
}
```

### If business id is not valid

```json
{
    "status": 200,
    "err": 1,
    "data": {},
    "msg": "Sorry, the business does not exist."
}
```

### If agent has already been invited

```json
{
    "status": 200,
    "err": 1,
    "data": {},
    "msg": "The agent has already been invited."
}
```






# Business Invitation List API

## Endpoint

`GET /api/business/invitation/list/:business_id/:start/:limit`

This endpoint retrieves a list of invitations sent by a business, based on the business ID, start index, and limit.

### Request

- Headers
  - `authorization`: Authorization token for the authenticated user.

- Parameters
  - `business_id`: Specifies the business ID. Should be a string of length 24 characters.
  - `start`: Specifies the starting index of the list to retrieve.
  - `limit`: Specifies the maximum number of items to retrieve.

### Response

- Status:
  - 200 OK if the operation is successful.
  - Error status codes for failures (e.g., 401 for unauthorized access).

- Body: JSON response containing the list of invitations or an error message.
  - If invitations are found, the response includes the total number of invitations and a list of invitation details.
  - If no invitations are found or an error occurs, an error message is returned.

### Notes

- Authentication is required via the `authorization` header.
- The `business_id` parameter specifies the ID of the business whose invitations are to be retrieved.
- The `start` parameter specifies the starting index of the list (pagination).
- The `limit` parameter specifies the maximum number of items to retrieve per request.
- Invitations are filtered based on specific criteria such as status, invitation type, and deletion status.
- The response includes pagination information for handling large invitation lists efficiently.
- Error messages are returned for scenarios like unauthorized access, invalid parameters, or internal server errors.

---

### Success Response (200 OK)

```json
{
    "status": 200,
    "err": 0,
    "data": {
        "total_invitation": 2,
        "invitation_list": [
            {
                "_id": "65f01f9e2ae3ebfa0fabab8a",
                "deleted": false,
                "user_id": "65efe616f5dae1ed2a2fed41",
                "user_name": "Agent_5",
                "profile_img_agent": "1710313412797_image_cropper_7E59F57F-425F-4BC1-99BA-E62E4927B0B9-8381-00000B96C7944195.jpg",
                "about_agent": "I am JobNow agent",
                "address": "Bangkok",
                "gender": 1
            },
            {
                "_id": "65f818abca50493e1f05fafe",
                "deleted": false,
                "user_id": "65efe5ccf5dae1ed2a2fed2d",
                "user_name": "Agent_2",
                "profile_img_agent": "1710313412797_image_cropper_7E59F57F-425F-4BC1-99BA-E62E4927B0B9-8381-00000B96C7944195.jpg",
                "about_agent": "I am JobNow agent",
                "address": "Bangkok",
                "gender": 1
            }
        ]
    },
    "msg": "List of invitations."
}
```

### Error Response (User Not Exist)

```json
{
  "status": 401,
  "err": 1,
  "data": {},
  "msg": "User not exist"
}
```

### If business id not provide in param:

```json
{
    "status": 406,
    "err": 1,
    "data": {
        "errors": [
            {
                "type": "field",
                "value": ":business_id",
                "msg": "Please vaild business id",
                "path": "business_id",
                "location": "params"
            }
        ]
    },
    "msg": "Please Enter All Fields"
}
```

### If business id is not valid

```json
{
    "status": 200,
    "err": 1,
    "data": {},
    "msg": "No invitations found."
}
```






# Acknowledge Agent Invitation API

## Endpoint

`POST /api/business/acknowledge-invitation/:business_id/:agent_id/:status`

This endpoint allows users to acknowledge and respond to invitations sent by a business to an agent.

### Request

- Headers
  - `authorization`: Authorization token for the authenticated user.

- Parameters
  - `business_id`: Specifies the business ID. Should be a string of length 24 characters.
  - `agent_id`: Specifies the agent's ID. Should be a string of length 24 characters.
  - `status`: Specifies the acknowledgment status (2 for accept, 3 for reject).

### Response

- Status:
  - 200 OK if the operation is successful.
  - Error status codes for failures (e.g., 401 for unauthorized access).

- Body: JSON response indicating the result of the acknowledgment.
  - If the acknowledgment is successful, a success message is returned along with relevant data.
  - If the acknowledgment fails (e.g., due to user not existing, invitation not found, invalid status, etc.), an error message is returned.

### Notes

- Authentication is required via the `authorization` header.
- The `business_id` parameter specifies the ID of the business whose invitation is being acknowledged.
- The `agent_id` parameter specifies the ID of the agent to whom the invitation was sent.
- The `status` parameter specifies the acknowledgment status (2 for accept, 3 for reject).
- Various checks are performed during acknowledgment, such as user existence, invitation existence, notification acknowledgment, and status validation.
- Invitations can be accepted or rejected based on the provided status.
- Error messages are returned for scenarios like unauthorized access, invalid parameters, invitation not found, or internal server errors.

---

### Success Response (200 OK)

```json
{
    "status": 200,
    "err": 0,
    "data": {
        "_id": "65f81c5c9a69f36673da5fbe",
        "user_id": "65efe525f5dae1ed2a2fed26",
        "business_id": "65bc7b14bf1407cea573a9cc",
        "about": "hiiiiii",
        "status": 2,
        "invitation_by": 1,
        "deleted": false,
        "created_by": "65efe525f5dae1ed2a2fed26",
        "updated_by": "65efe525f5dae1ed2a2fed26",
        "created_at": "2024-03-18T10:50:04.809Z",
        "updated_at": "2024-03-18T11:38:08.986Z",
        "__v": 0
    },
    "msg": "Invitation accepted successfully."
}
```

### Error Response (User Not Exist)

```json
{
  "status": 401,
  "err": 1,
  "data": {},
  "msg": "User not exist"
}
```

### If business id,agent id and status not provide in param:

```json
{
    "status": 406,
    "err": 1,
    "data": {
        "errors": [
            {
                "type": "field",
                "value": ":business_id",
                "msg": "Please vaild business id",
                "path": "business_id",
                "location": "params"
            },
            {
                "type": "field",
                "value": ":agent_id",
                "msg": "Please vaild agent id",
                "path": "agent_id",
                "location": "params"
            },
            {
                "type": "field",
                "value": ":status",
                "msg": "Invalid value",
                "path": "status",
                "location": "params"
            }
        ]
    },
    "msg": "Please Enter All Fields"
}
```
### If business id is not valid

```json
{
    "status": 200,
    "err": 1,
    "data": {},
    "msg": "Invitation for the job does not exist."
}
```

### If agent id is not valid

```json
{
    "status": 200,
    "err": 1,
    "data": {},
    "msg": "Sorry, the agent does not exist."
}
```

### If status is not valid

```json
{
    "status": 200,
    "err": 1,
    "data": {},
    "msg": "Please apply with a valid status."
}
```






# Conversation Group Member List API

## Endpoint

`POST /api/business/conversation-group-member/list/:business_id/:group_id`

This endpoint is used to fetch the list of members in a conversation group associated with a specific business.

### Request Headers

- `Authorization`: Authorization header is required and must not be empty.

### Request Parameters

- `business_id` (URL parameter): The ID of the business to fetch group members for.
- `group_id` (URL parameter): The ID of the conversation group to fetch members from.

### Notes

- This API is used to fetch the list of members in a conversation group associated with a specific business.
- The middleware groupMemberListMid handles authorization and request validation for this endpoint.
- The response includes details about each group member, such as name, role, profile image, and member type.

### Middleware

This middleware function `groupMemberListMid` handles the request validation and authorization.

### Group Member List Process

The API checks the user's authorization, validates the request parameters, and then fetches the list of members in the specified conversation group associated with the given business ID.

### Success Response Example

```json
{
    "status": 200,
    "err": 0,
    "data": [
        {
            "_id": "65bc7b14bf1407cea573a9d3",
            "business_id": "65bc7b14bf1407cea573a9cc",
            "user_id": "65bc7b14bf1407cea573a9c6",
            "role": 1,
            "staff_profile_image": null,
            "is_group_member": true,
            "member_name": "Test Business Owner"
        },
        {
            "_id": "65f827a1ca50493e1f05fb5c",
            "business_id": "65bc7b14bf1407cea573a9cc",
            "user_id": "65efe525f5dae1ed2a2fed26",
            "member_type": 4,
            "is_group_member": false,
            "member_name": "Agent_1"
        }
    ],
    "msg": "List of group members."
}
```

### Error Response (User Not Exist)

```json
{
  "status": 401,
  "err": 1,
  "data": {},
  "msg": "User not exist"
}
```

### Error Response for invalid business id

```json
{
    "status": 200,
    "err": 1,
    "data": {},
    "msg": "Sorry, you are not a member of this business. Please contact the administrator for access."
}
```

### Error Response for empty fields

```json
{
    "status": 406,
    "err": 1,
    "data": {
        "errors": [
            {
                "type": "field",
                "value": ":business_id",
                "msg": "Please vaild business id",
                "path": "business_id",
                "location": "params"
            }
        ]
    },
    "msg": "Please Enter All Fields"
}
```






# FCM Business API

## Endpoint

`POST /api/business/switch`

This endpoint is used to switch the FCM token to a different business.

### Request Headers

- `authorization`: The authorization token for authentication. It must not be empty.

### Request Body

- `fcm_token`: The FCM token to be switched. It must not be empty.

### Notes

- This API is used to switch the FCM token to a different business.
- It requires authorization through the authorization header.
- The FCM token must be provided in the request body.

### Middleware

The `setFcmBusinessMid` middleware is applied to handle the request processing.

### FCM Business Switch Process

The API switches the FCM token to the specified business. If the operation is successful, it returns a success response; otherwise, it returns an error response.

### Success Response Example

```json
{
    "status": 200,
    "err": 0,
    "data": {},
    "msg": "The business is set with the FCM token."
}
```
### Error response

```json
{
    "status": 200,
    "err": 1,
    "data": {},
    "msg": "The business is not set with the FCM token. Please try again.."
}
```

### Error response(Not member of business)

```json
{
    "status": 200,
    "err": 1,
    "data": {},
    "msg": "Sorry, you are not a member of this business. Please contact the administrator for access."
}
```

### Error Response for empty fields

```json
{
    "status": 406,
    "err": 1,
    "data": {
        "errors": [
            {
                "type": "field",
                "value": "",
                "msg": "Invalid value",
                "path": "fcm_token",
                "location": "body"
            }
        ]
    },
    "msg": "Please Enter All Fields"
}
```